

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>User Manual &mdash; pysuite 0.4.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Auth" href="auth.html" />
    <link rel="prev" title="Welcome to pysuite’s documentation!" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> pysuite
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">User Manual</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#authentication">Authentication</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#get-credentials">Get credentials</a></li>
<li class="toctree-l3"><a class="reference internal" href="#authenticate">Authenticate</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#drive">Drive</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#download">download</a></li>
<li class="toctree-l3"><a class="reference internal" href="#upload">upload</a></li>
<li class="toctree-l3"><a class="reference internal" href="#delete">delete</a></li>
<li class="toctree-l3"><a class="reference internal" href="#copy">copy</a></li>
<li class="toctree-l3"><a class="reference internal" href="#list">list</a></li>
<li class="toctree-l3"><a class="reference internal" href="#share">share</a></li>
<li class="toctree-l3"><a class="reference internal" href="#create-folder">create_folder</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#sheets">Sheets</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#to-sheet">to_sheet</a></li>
<li class="toctree-l3"><a class="reference internal" href="#read-sheet">read_sheet</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">download</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">upload</a></li>
<li class="toctree-l3"><a class="reference internal" href="#clear">clear</a></li>
<li class="toctree-l3"><a class="reference internal" href="#create-spreadsheet">create_spreadsheet</a></li>
<li class="toctree-l3"><a class="reference internal" href="#create-sheet">create_sheet</a></li>
<li class="toctree-l3"><a class="reference internal" href="#delete-sheet">delete_sheet</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rename-sheet">rename_sheet</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#gmail">GMail</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#compose">compose</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#credential-for-google-cloud">Credential for Google Cloud</a></li>
<li class="toctree-l2"><a class="reference internal" href="#vision">Vision</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id5">Authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="#instantiate-vision-class">Instantiate Vision Class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#service-types">Service Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="#annotate-one-image">Annotate One Image</a></li>
<li class="toctree-l3"><a class="reference internal" href="#batch-annotations">Batch Annotations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#convert-to-json">Convert To Json</a></li>
<li class="toctree-l3"><a class="reference internal" href="#async-annotation">Async Annotation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#storage">Storage</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id6">Authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="#instantiate-storage-class">Instantiate Storage Class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#upload-download-move-and-remove-files">Upload, Download, Move and Remove Files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#create-remove-and-get-bucket">Create, Remove and Get Bucket</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="auth.html">Auth</a></li>
<li class="toctree-l1"><a class="reference internal" href="drive.html">Drive</a></li>
<li class="toctree-l1"><a class="reference internal" href="sheets.html">Sheets</a></li>
<li class="toctree-l1"><a class="reference internal" href="gmail.html">GMail</a></li>
<li class="toctree-l1"><a class="reference internal" href="vision.html">Vision</a></li>
<li class="toctree-l1"><a class="reference internal" href="storage.html">Storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="utilities.html">utilities</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pysuite</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>User Manual</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/user_manual.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="user-manual">
<span id="id1"></span><h1>User Manual<a class="headerlink" href="#user-manual" title="Permalink to this headline">¶</a></h1>
<p>This page provides a quick introduction of some basic classes in pysuite as well as some exmaple of their usages. For
detailed documentation, please refer to the corresponding pages for each class.</p>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>pysuite is tested under linux for python 3.6, 3.7 and 3.8. It is also expected to run on MacOS. Certain efforts have
been spent to avoid OS dependencies. However, it has not been tested under Windows.</p>
<p>The easiest way to install pysuite is to use pip:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install pysuite
</pre></div>
</div>
<p>Alternatively, you can clone <a class="reference external" href="https://github.com/staftermath/pysuite">pysuite repo</a> and run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python setup.py install
</pre></div>
</div>
</div>
<div class="section" id="authentication">
<h2>Authentication<a class="headerlink" href="#authentication" title="Permalink to this headline">¶</a></h2>
<div class="section" id="get-credentials">
<h3>Get credentials<a class="headerlink" href="#get-credentials" title="Permalink to this headline">¶</a></h3>
<p>You need to get a credential from <a class="reference external" href="https://console.developers.google.com/apis/dashboard">Google API Console</a>. The
credential looks like:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;installed&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;client_id&quot;</span><span class="p">:</span> <span class="s2">&quot;xxxxxxxxxxxxxxxxx.apps.googleusercontent.com&quot;</span><span class="p">,</span>
    <span class="nt">&quot;project_id&quot;</span><span class="p">:</span> <span class="s2">&quot;xxxxxxxxxxxxx-xxxxxxxxxxxx&quot;</span><span class="p">,</span>
    <span class="nt">&quot;auth_uri&quot;</span><span class="p">:</span> <span class="s2">&quot;https://accounts.google.com/o/oauth2/auth&quot;</span><span class="p">,</span>
    <span class="nt">&quot;token_uri&quot;</span><span class="p">:</span> <span class="s2">&quot;https://oauth2.googleapis.com/token&quot;</span><span class="p">,</span>
    <span class="nt">&quot;auth_provider_x509_cert_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://www.googleapis.com/oauth2/v1/certs&quot;</span><span class="p">,</span>
    <span class="nt">&quot;client_secret&quot;</span><span class="p">:</span> <span class="s2">&quot;xxxxxxxxxxxxxxxx&quot;</span><span class="p">,</span>
    <span class="nt">&quot;redirect_uris&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="s2">&quot;urn:ietf:wg:oauth:2.0:oob&quot;</span><span class="p">,</span>
      <span class="s2">&quot;http://localhost&quot;</span>
    <span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>You need to save this credential to a json file and pass to <code class="code docutils literal notranslate"><span class="pre">Authentication</span></code> class.
In addition, you need to have a file to store refresh token. A json object will be written to the token file every time
Authentication file is instantiated.</p>
<p>The token file will be written in the following json format:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;token&quot;</span><span class="p">:</span> <span class="s2">&quot;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&quot;</span><span class="p">,</span>
    <span class="nt">&quot;refresh_token&quot;</span><span class="p">:</span> <span class="s2">&quot;xxxxxxxxxxxx&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="authenticate">
<h3>Authenticate<a class="headerlink" href="#authenticate" title="Permalink to this headline">¶</a></h3>
<p>Once you created a credential file from the previous section, <code class="code docutils literal notranslate"><span class="pre">Authentication</span></code> can help authenticate your
credential and provide clients for API class such as <code class="code docutils literal notranslate"><span class="pre">Drive</span></code>, <code class="code docutils literal notranslate"><span class="pre">Sheets</span></code> and <code class="code docutils literal notranslate"><span class="pre">GMail</span></code>. Google API uses a
refresh token to periodically refresh your credential. By keeping a token file, you will not be needing to manually
authorize your credential file through browser. <code class="code docutils literal notranslate"><span class="pre">Authentication</span></code> helps you automatically refresh token when
expired. An <code class="code docutils literal notranslate"><span class="pre">Authentication</span></code> class can be instantiated as follows.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pysuite</span> <span class="kn">import</span> <span class="n">Authentication</span>

<span class="n">credential_file</span> <span class="o">=</span> <span class="s2">&quot;./credentials/credentials.json&quot;</span>
<span class="n">token_file</span> <span class="o">=</span> <span class="s2">&quot;./credentials/token.json&quot;</span>

<span class="n">drive_auth</span> <span class="o">=</span> <span class="n">Authentication</span><span class="p">(</span><span class="n">credential</span><span class="o">=</span><span class="n">credential_file</span><span class="p">,</span> <span class="n">token</span><span class="o">=</span><span class="n">token_file</span><span class="p">,</span> <span class="n">services</span><span class="o">=</span><span class="s2">&quot;drive&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>this will prompt a web browser confirmation for the first time if <code class="code docutils literal notranslate"><span class="pre">token</span></code> file is not created. Once
you confirm access, the token will be created/overwritten. Future authorization will automatically use the token file.
No manual confirmation will be needed.</p>
<p>You may provide a string or a list of services. Currently accepted services are ‘drive’, ‘sheets’ or ‘gmail’. With
<code class="code docutils literal notranslate"><span class="pre">Authentication</span></code> class, You can generate different service used by corresponding API class such as <code class="code docutils literal notranslate"><span class="pre">Drive</span></code>,
<code class="code docutils literal notranslate"><span class="pre">Sheet</span></code> or <code class="code docutils literal notranslate"><span class="pre">GMail</span></code>. Only service whose service type is authorized in <code class="code docutils literal notranslate"><span class="pre">Authentication</span></code> can be created.
If more than one service was authorized at instantiation, you must specify service type in <code class="code docutils literal notranslate"><span class="pre">get_service_client</span></code>:
For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">drive_and_sheet_auth</span> <span class="o">=</span> <span class="n">Authentication</span><span class="p">(</span><span class="n">credential</span><span class="o">=</span><span class="n">credential_file</span><span class="p">,</span> <span class="n">token</span><span class="o">=</span><span class="n">token_file</span><span class="p">,</span> <span class="n">services</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;drive&quot;</span><span class="p">,</span> <span class="s2">&quot;sheet&quot;</span><span class="p">])</span>
<span class="n">sheet_and_gmail_auth</span> <span class="o">=</span> <span class="n">Authentication</span><span class="p">(</span><span class="n">credential</span><span class="o">=</span><span class="n">credential_file</span><span class="p">,</span> <span class="n">token</span><span class="o">=</span><span class="n">token_file</span><span class="p">,</span> <span class="n">services</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;sheet&quot;</span><span class="p">,</span> <span class="s2">&quot;gmail&quot;</span><span class="p">])</span>
<span class="n">sheet_only_auth</span> <span class="o">=</span> <span class="n">Authentication</span><span class="p">(</span><span class="n">credential</span><span class="o">=</span><span class="n">credential_file</span><span class="p">,</span> <span class="n">token</span><span class="o">=</span><span class="n">token_file</span><span class="p">,</span> <span class="n">services</span><span class="o">=</span><span class="s2">&quot;sheet&quot;</span><span class="p">)</span>

<span class="n">drive_and_sheet_auth</span><span class="o">.</span><span class="n">get_service_client</span><span class="p">(</span><span class="s2">&quot;drive&quot;</span><span class="p">)</span>  <span class="c1"># get a service client for Drive</span>
<span class="n">drive_and_sheet_auth</span><span class="o">.</span><span class="n">get_service_client</span><span class="p">(</span><span class="s2">&quot;sheet&quot;</span><span class="p">)</span>  <span class="c1"># get a service client for Sheet</span>
<span class="n">drive_and_sheet_auth</span><span class="o">.</span><span class="n">get_service_client</span><span class="p">(</span><span class="s2">&quot;gmail&quot;</span><span class="p">)</span>  <span class="c1"># this will not work since gmail is not authorized</span>
<span class="n">drive_and_sheet_auth</span><span class="o">.</span><span class="n">get_service_client</span><span class="p">()</span>  <span class="c1"># this will not work since multiple types were authorized.</span>
<span class="n">sheet_only_auth</span><span class="o">.</span><span class="n">get_service_client</span><span class="p">()</span>  <span class="c1"># this works since there is only one auth type</span>
</pre></div>
</div>
<p>The token file is associated with authorized services. In order to successfully authorize your credential, you need to
first enable API through <a class="reference external" href="https://console.developers.google.com/apis/dashboard">Google API Console</a>.</p>
</div>
</div>
<div class="section" id="drive">
<h2>Drive<a class="headerlink" href="#drive" title="Permalink to this headline">¶</a></h2>
<p>This class provides APIs used to access and operate with Google drive files. You may utilize <code class="code docutils literal notranslate"><span class="pre">Authentication</span></code>
class to create an authenticated API class:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pysuite</span> <span class="kn">import</span> <span class="n">Drive</span>

<span class="c1"># drive_auth is an Authentication object with &#39;drive&#39; service authorized.</span>
<span class="n">drive</span> <span class="o">=</span> <span class="n">Drive</span><span class="p">(</span><span class="n">service</span><span class="o">=</span><span class="n">drive_auth</span><span class="o">.</span><span class="n">get_service_client</span><span class="p">())</span>
</pre></div>
</div>
<p>If you prefer different method to create gdrive client, you may switch <code class="code docutils literal notranslate"><span class="pre">drive_auth.get_service_client()</span></code> with a
gdrive service (See <a class="reference external" href="https://developers.google.com/drive/api/v3/quickstart/python">Google Drive API V3</a> for detail):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">service</span> <span class="o">=</span> <span class="n">build</span><span class="p">(</span><span class="s1">&#39;drive&#39;</span><span class="p">,</span> <span class="s1">&#39;v3&#39;</span><span class="p">,</span> <span class="n">credentials</span><span class="o">=</span><span class="n">creds</span><span class="p">)</span>
</pre></div>
</div>
<p>Many methods in this class has parameter <code class="code docutils literal notranslate"><span class="pre">id</span></code>. This represent the gdrive object id. There are several ways to get
the id of a Google Drive object. Some methods in <code class="code docutils literal notranslate"><span class="pre">Drive</span></code> can also help you to find it. To do it manually, right
click on any Google Drive object (file or folder) and click <cite>get link</cite>, then copy the prompted link, it may look like
this: <a class="reference external" href="https://drive.google.com/drive/folders/1qcfrD7RqZWwPVO9C7tbL1PNRa2aUQlF8?usp=sharing">https://drive.google.com/drive/folders/1qcfrD7RqZWwPVO9C7tbL1PNRa2aUQlF8?usp=sharing</a>. The id of this object is
<strong>1qcfrD7RqZWwPVO9C7tbL1PNRa2aUQlF8</strong>. You can get id of most Google Suite object this way.</p>
<p>All methods in <code class="code docutils literal notranslate"><span class="pre">Drive</span></code> that interacts with Google API can be configured to retry on Quota Error. Please refer to
<a class="reference internal" href="drive.html#drive"><span class="std std-ref">Drive</span></a> to see how to control the number of retries and sleep time.</p>
<div class="section" id="download">
<h3>download<a class="headerlink" href="#download" title="Permalink to this headline">¶</a></h3>
<p>Download a file to local.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">drive</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;google drive object id&quot;</span><span class="p">,</span> <span class="n">to_file</span><span class="o">=</span><span class="s2">&quot;/tmp/test_file&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="upload">
<h3>upload<a class="headerlink" href="#upload" title="Permalink to this headline">¶</a></h3>
<p>Upload a local file to google drive. you can provide the id of a folder to place the uploaded file under that folder.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">drive</span><span class="o">.</span><span class="n">upload</span><span class="p">(</span><span class="n">from_file</span><span class="o">=</span><span class="s2">&quot;path/to/your/file/to/be/uploaded&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;google_drive_file_name&quot;</span><span class="p">,</span>
             <span class="n">parent_id</span><span class="o">=</span><span class="s2">&quot;google drive folder id 1&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="delete">
<h3>delete<a class="headerlink" href="#delete" title="Permalink to this headline">¶</a></h3>
<p>Delete a google drive file/folder. Parameter <code class="code docutils literal notranslate"><span class="pre">recursive</span></code> has not been implemented.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">drive</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;id_of_target_object&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="copy">
<h3>copy<a class="headerlink" href="#copy" title="Permalink to this headline">¶</a></h3>
<p>Copy one google drive file to another. The new file will be named by <code class="code docutils literal notranslate"><span class="pre">name</span></code>. You can provide the id of a folder
to place the new file under that folder.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">drive</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;id_of_target_file&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;name of new file&quot;</span><span class="p">,</span> <span class="n">parent_id</span><span class="o">=</span><span class="s2">&quot;new parent folder id&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="list">
<h3>list<a class="headerlink" href="#list" title="Permalink to this headline">¶</a></h3>
<p>List files under the target folder. If the id is not a folder or there is no object in the folder, an empty list will be
returned. You can also pass a regular expression string to filter the result. Note that this filter is done post-query.
Which means list of all files under the target folder will still be downloaded first. You can also list recursively up
to a maximum depth. This may save some time if you do not intend to search deeply nested folders.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">list_of_objects</span> <span class="o">=</span> <span class="n">drive</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;google drive folder id&quot;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="s2">&quot;^test$&quot;</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="share">
<h3>share<a class="headerlink" href="#share" title="Permalink to this headline">¶</a></h3>
<p>Share a google drive object with a list of emails. You can grant the role such as <strong>owner</strong>, <strong>organizer</strong>,
<strong>fileOrganzier</strong>, <strong>writer</strong>, <strong>commenter</strong> or <strong>reader</strong>. You can also choose to notify the shared emails.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">drive</span><span class="o">.</span><span class="n">share</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;google drive object id&quot;</span><span class="p">,</span> <span class="n">emails</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;user1@gmail.com&quot;</span><span class="p">,</span> <span class="s2">&quot;user2@gmail.com&quot;</span><span class="p">],</span>
            <span class="n">role</span><span class="o">=</span><span class="s2">&quot;reader&quot;</span><span class="p">,</span> <span class="n">notify</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="create-folder">
<h3>create_folder<a class="headerlink" href="#create-folder" title="Permalink to this headline">¶</a></h3>
<p>Create a folder on google drive.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">drive</span><span class="o">.</span><span class="n">create_folder</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;awesome_new_folder&quot;</span><span class="p">,</span> <span class="n">parent_ids</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;parent_folder_id&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="sheets">
<h2>Sheets<a class="headerlink" href="#sheets" title="Permalink to this headline">¶</a></h2>
<p>This class provides APIs used to access and operate with Google spreadsheet files. Many <cite>Sheets</cite> methods has parameter
<code class="code docutils literal notranslate"><span class="pre">range</span></code>. This needs to follow <a class="reference external" href="https://developers.google.com/sheets/api/guides/concepts#a1_notation">A1 Notation</a>.
To instantiate Sheets class:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pysuite</span> <span class="kn">import</span> <span class="n">Sheets</span>
<span class="c1"># sheets_auth is an Authentication object with &#39;sheets&#39; type of service authorized</span>
<span class="n">sheets</span> <span class="o">=</span> <span class="n">Sheets</span><span class="p">(</span><span class="n">service</span><span class="o">=</span><span class="n">sheets_auth</span><span class="o">.</span><span class="n">get_service_client</span><span class="p">())</span>
</pre></div>
</div>
<p>If you prefer different method to create gsheet client, you may switch <code class="code docutils literal notranslate"><span class="pre">sheets_auth.get_service_client()</span></code> with a
google sheet service (See <a class="reference external" href="https://developers.google.com/sheets/api/quickstart/python">Google Sheet API V4</a> for details):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">service</span> <span class="o">=</span> <span class="n">build</span><span class="p">(</span><span class="s1">&#39;sheets&#39;</span><span class="p">,</span> <span class="s1">&#39;v4&#39;</span><span class="p">,</span> <span class="n">credentials</span><span class="o">=</span><span class="n">creds</span><span class="p">,</span> <span class="n">cache_discovery</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>All methods in <code class="code docutils literal notranslate"><span class="pre">Sheets</span></code> that calls Google API can be configured to retry on Quota Error. Please refer to
<a class="reference internal" href="sheets.html#sheets"><span class="std std-ref">Sheets</span></a> to see how to control the number of retries and sleep time</p>
<div class="section" id="to-sheet">
<h3>to_sheet<a class="headerlink" href="#to-sheet" title="Permalink to this headline">¶</a></h3>
<p>Upload a pandas dataframe to a specified range of sheet. This will clear the target range before uploading. The data in
the provided dataframe must be serializable. For example, date type may not be correctly uploaded. In such cases, you
might need to convert these columns to strings first.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;col1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;col2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">]})</span>
<span class="n">sheets</span><span class="o">.</span><span class="n">to_sheet</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;your_sheet_id&quot;</span><span class="p">,</span> <span class="n">sheet_range</span><span class="o">=</span><span class="s2">&quot;yourtab!A1:B&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="read-sheet">
<h3>read_sheet<a class="headerlink" href="#read-sheet" title="Permalink to this headline">¶</a></h3>
<p>Download target sheet range into a pandas DataFrame. This api requires pandas.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">sheets</span><span class="o">.</span><span class="n">read_sheet</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;your_sheet_id&quot;</span><span class="p">,</span> <span class="n">sheet_range</span><span class="o">=</span><span class="s2">&quot;yourtab!A1:D&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The raw data downloaded are all of string type, hence the dtypes of all columns in the created dataframe will be <cite>object</cite>.
The parameter <code class="code docutils literal notranslate"><span class="pre">dtypes</span></code> can be utilized to columns to the desired types.</p>
<p>Note that Google sheet API ignores trailing empty cells in a row. As A result, the values read from the sheet may have
fewer entries then expected. As a result, it causes error when attempting to convert the values into
pandas DataFrame. This issue can be fixed by passing <code class="code docutils literal notranslate"><span class="pre">fill_row=True</span></code> (default) with some sacrifice of performance.
In addition, when both <code class="code docutils literal notranslate"><span class="pre">fill_row</span></code> and <code class="code docutils literal notranslate"><span class="pre">header</span></code> are <code class="code docutils literal notranslate"><span class="pre">True</span></code>, the method will attempt to fill missing
header with <cite>_col{i}</cite> where i is the index of the column. If you are certain no trailing cells exist in the target
range, you may turn it off for performance gain.</p>
</div>
<div class="section" id="id3">
<h3>download<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>Download sheet into a list of values either in <strong>ROWS</strong> format or in <strong>COLUMNS</strong> format. This is useful when you do not
want to add pandas as dependency.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">values</span> <span class="o">=</span> <span class="n">sheets</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;your_sheet_id&quot;</span><span class="p">,</span> <span class="n">sheet_range</span><span class="o">=</span><span class="s2">&quot;yourtab!A1:D&quot;</span><span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="s2">&quot;ROWS&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that Google sheet API ignores trailing empty cells in a row. This behavior leads to the result that the values read
from the sheet may have fewer entries then expected. You can pass <code class="code docutils literal notranslate"><span class="pre">fill_row=True</span></code> to fill all such trailing empty
cells with empty strings. This comes with some sacrifice of performance but will guarantee to return homogeneous list.
<code class="code docutils literal notranslate"><span class="pre">fill_row=True</span></code> only works when <code class="code docutils literal notranslate"><span class="pre">dimension=&quot;ROWS&quot;</span></code>. This is default to be False.</p>
</div>
<div class="section" id="id4">
<h3>upload<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>Upload a list of lists to specified google sheet range. This is useful when you do not want to add pandas as dependency.
The target range will be cleared before new content is uploaded. All entries in the provided list must be serializable.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">values</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">]]</span>
<span class="n">sheets</span><span class="o">.</span><span class="n">upload</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;your_sheet_id&quot;</span><span class="p">,</span> <span class="n">sheet_range</span><span class="o">=</span><span class="s2">&quot;yourtab!A1:B&quot;</span><span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="s2">&quot;ROWS&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="clear">
<h3>clear<a class="headerlink" href="#clear" title="Permalink to this headline">¶</a></h3>
<p>Remove contents of specified Goolge sheet range.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sheets</span><span class="o">.</span><span class="n">clear</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;your_sheet_id&quot;</span><span class="p">,</span> <span class="n">sheet_range</span><span class="o">=</span><span class="s2">&quot;yourtab!A1:B&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="create-spreadsheet">
<h3>create_spreadsheet<a class="headerlink" href="#create-spreadsheet" title="Permalink to this headline">¶</a></h3>
<p>Google api does not support create spreadsheet in a folder.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sheets</span><span class="o">.</span><span class="n">create_spreadsheet</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;new_spread_sheet_name&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="create-sheet">
<h3>create_sheet<a class="headerlink" href="#create-sheet" title="Permalink to this headline">¶</a></h3>
<p>Create a tab (sheet) in a spreadsheet. return the id of created tab.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sheets</span><span class="o">.</span><span class="n">create_sheet</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;id_of_spreadsheet&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;new_tab_name&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="delete-sheet">
<h3>delete_sheet<a class="headerlink" href="#delete-sheet" title="Permalink to this headline">¶</a></h3>
<p>Delete a tab (sheet) in a spreadsheet. You can find the id of the tab from URL. For example, if URL of a tab is
<a class="reference external" href="https://docs.google.com/spreadsheets/d/1CNOH3o2Zz05mharkLXuwX72FpRka8-KFpIm9bEaja50/edit#gid=388610320">https://docs.google.com/spreadsheets/d/1CNOH3o2Zz05mharkLXuwX72FpRka8-KFpIm9bEaja50/edit#gid=388610320</a>, then the tab id
is <cite>388610320</cite></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sheets</span><span class="o">.</span><span class="n">delete_sheet</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;id_of_spreadsheet&quot;</span><span class="p">,</span> <span class="n">sheet_id</span><span class="o">=</span><span class="s2">&quot;id_of_tab&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="rename-sheet">
<h3>rename_sheet<a class="headerlink" href="#rename-sheet" title="Permalink to this headline">¶</a></h3>
<p>Rename a tab in a spreadsheet.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sheets</span><span class="o">.</span><span class="n">rename_sheet</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;id_of_spreadsheet&quot;</span><span class="p">,</span> <span class="n">sheet_id</span><span class="o">=</span><span class="s2">&quot;id_of_tab&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;new_tab_name&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="gmail">
<h2>GMail<a class="headerlink" href="#gmail" title="Permalink to this headline">¶</a></h2>
<p>This class provides APIs used to access and operate with Gmail API. This class uses Google API istead of more commonly
used SMTP. To instantiate a <code class="code docutils literal notranslate"><span class="pre">GMail</span></code> class:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pysuite</span> <span class="kn">import</span> <span class="n">GMail</span>
<span class="c1"># gmail_auth is an Authentication object with &#39;gmail&#39; type service authorized.</span>
<span class="n">sheets</span> <span class="o">=</span> <span class="n">GMail</span><span class="p">(</span><span class="n">service</span><span class="o">=</span><span class="n">gmail_auth</span><span class="o">.</span><span class="n">get_service_client</span><span class="p">())</span>
</pre></div>
</div>
<p>If you prefer different method to create gmail client, you may switch <code class="code docutils literal notranslate"><span class="pre">gmail_auth.get_service_client()</span></code> with a
google gmail service (See <a class="reference external" href="https://developers.google.com/gmail/api/quickstart/python">Gmail API</a> for details):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">service</span> <span class="o">=</span> <span class="n">build</span><span class="p">(</span><span class="s1">&#39;gmail&#39;</span><span class="p">,</span> <span class="s1">&#39;v1&#39;</span><span class="p">,</span> <span class="n">credentials</span><span class="o">=</span><span class="n">creds</span><span class="p">,</span> <span class="n">cache_discovery</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="compose">
<h3>compose<a class="headerlink" href="#compose" title="Permalink to this headline">¶</a></h3>
<p>Write and send an email. You can attach local files and/or Google Drive files. The Google Drive files will be attached
directly in the body as external links.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">gmail</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="n">body</span><span class="o">=</span><span class="s2">&quot;hello world&quot;</span><span class="p">,</span>
              <span class="n">sender</span><span class="o">=</span><span class="s2">&quot;youremail@gmail.com&quot;</span><span class="p">,</span>
              <span class="n">subject</span><span class="o">=</span><span class="s2">&quot;this is a test email&quot;</span><span class="p">,</span>
              <span class="n">to</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;recipient1@gmail.com&quot;</span><span class="p">,</span> <span class="s2">&quot;recipient2@hotmail.com&quot;</span><span class="p">],</span>
              <span class="n">local_files</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;/tmp/file.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;/tmp/another_file.csv&quot;</span><span class="p">],</span>
              <span class="n">gdrive_ids</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;gdrivefile_id1&quot;</span><span class="p">,</span> <span class="s2">&quot;gdrive_file_id2&quot;</span><span class="p">]</span>
              <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="credential-for-google-cloud">
<h2>Credential for Google Cloud<a class="headerlink" href="#credential-for-google-cloud" title="Permalink to this headline">¶</a></h2>
<p>Pysuite also provides python apis for some Google Cloud services such as Google Vision. These class requires Google Cloud
Service credential. It is a completely different credential from that for drive, gmail and sheets API. You can find
the steps to obtain the credential file from <a class="reference external" href="https://cloud.google.com/vision/docs/before-you-begin">this page</a>.</p>
</div>
<div class="section" id="vision">
<h2>Vision<a class="headerlink" href="#vision" title="Permalink to this headline">¶</a></h2>
<p>This class provides python apis to access Google Vision api. You can get started to understand what Google Vision
provides from this <a class="reference external" href="https://cloud.google.com/vision/docs/quickstarts">quickstarts</a>. Currently please note that
asynchronized apis are not supported. This will be supported in the future update.</p>
<div class="section" id="id5">
<h3>Authentication<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<p>You can authenticate the connection in the same way as drive, gmail or sheets. Since the vision service credential file
is different from that for drive, gmail or sheets, you cannot authenticate them together. Additionally, <cite>token</cite> is not
required for vision.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">vision_auth</span> <span class="o">=</span> <span class="n">Authentication</span><span class="p">(</span><span class="n">credential</span><span class="o">=</span><span class="n">cloud_service_file</span><span class="p">,</span> <span class="n">services</span><span class="o">=</span><span class="s2">&quot;vision&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="instantiate-vision-class">
<h3>Instantiate Vision Class<a class="headerlink" href="#instantiate-vision-class" title="Permalink to this headline">¶</a></h3>
<p>Using the authenticated object, you can instantiate a vision class by:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">vision</span> <span class="o">=</span> <span class="n">Vision</span><span class="p">(</span><span class="n">service</span><span class="o">=</span><span class="n">vision_auth</span><span class="o">.</span><span class="n">get_service_client</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="section" id="service-types">
<h3>Service Types<a class="headerlink" href="#service-types" title="Permalink to this headline">¶</a></h3>
<p>All vision annotation services provided by Google Vision API are supported. You can find some examples from the official
document, such as <a class="reference external" href="https://cloud.google.com/vision/docs/ocr">OCR</a>,
<a class="reference external" href="https://cloud.google.com/vision/docs/labels">label detection</a> and more. Please see the following sections for examples
of making various annotation requests. You can find the complete list of features from
<a class="reference external" href="https://github.com/googleapis/python-vision/blob/main/google/cloud/vision_v1/types/image_annotator.py#L105-L119">google vision github</a>.
For example, “TEXT_DETECTION” is listed as one of the service, hence you can pass a string of <cite>“TEXT_DETECTION”</cite> or
<cite>[“TEXT_DETECTION”]</cite> to <cite>methods</cite> to request a test detection annotation. This is case insensitive.</p>
</div>
<div class="section" id="annotate-one-image">
<h3>Annotate One Image<a class="headerlink" href="#annotate-one-image" title="Permalink to this headline">¶</a></h3>
<p>If you want to annotate just one image, you can utilize <cite>annotate_image</cite> method:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">vision</span><span class="o">.</span><span class="n">annotate_image</span><span class="p">(</span><span class="n">test_image</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;text_detection&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>Here <cite>test_image</cite> is the path to the image file to be annotated. You can pass a single string or a list of strings to
<cite>methods</cite>. They will be allowed vision services. The returned object is an <cite>AnnotateImageResponse</cite> object containing
very granular information on the results.</p>
</div>
<div class="section" id="batch-annotations">
<h3>Batch Annotations<a class="headerlink" href="#batch-annotations" title="Permalink to this headline">¶</a></h3>
<p>If you have a few images, you can utlize <cite>add_request</cite> and <cite>batch_annotate_image</cite> methods to annotate them in one api
call:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">vision</span><span class="o">.</span><span class="n">add_request</span><span class="p">(</span><span class="n">image_path</span><span class="o">=</span><span class="n">first_test_image</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="s2">&quot;text_detection&quot;</span><span class="p">)</span>
<span class="n">vision</span><span class="o">.</span><span class="n">add_request</span><span class="p">(</span><span class="n">image_path</span><span class="o">=</span><span class="n">second_test_image</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;text_detection&quot;</span><span class="p">,</span> <span class="s2">&quot;label_detection&quot;</span><span class="p">])</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">vision</span><span class="o">.</span><span class="n">batch_annotate_image</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="convert-to-json">
<h3>Convert To Json<a class="headerlink" href="#convert-to-json" title="Permalink to this headline">¶</a></h3>
<p>The results from API calls are <cite>AnnotateImageResponse</cite> objects. While they have many convenient methods to help operate
on them, they are not directly serializable. You can use <cite>to_json</cite> method to store these objects to serializable object:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">json_result</span> <span class="o">=</span> <span class="n">Vision</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="async-annotation">
<h3>Async Annotation<a class="headerlink" href="#async-annotation" title="Permalink to this headline">¶</a></h3>
<p>You can use <cite>add_request</cite> to add images on Google Cloud Storage and annotate them asynchronously.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">gcs_test_image</span> <span class="o">=</span> <span class="s2">&quot;gc://my-bucket/path/to/my/image.jpg&quot;</span>
<span class="c1"># Add multiple requests</span>
<span class="n">vision</span><span class="o">.</span><span class="n">add_request</span><span class="p">(</span><span class="n">image_path</span><span class="o">=</span><span class="n">gcs_test_image</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="s2">&quot;text_detection&quot;</span><span class="p">)</span>
<span class="n">vision</span><span class="o">.</span><span class="n">add_request</span><span class="p">(</span><span class="n">image_path</span><span class="o">=</span><span class="n">gcs_test_image</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;text_detection&quot;</span><span class="p">,</span> <span class="s2">&quot;label_detection&quot;</span><span class="p">])</span>

<span class="c1"># Trigger async annotation</span>
<span class="n">output_path</span> <span class="o">=</span> <span class="s2">&quot;gc://my-bucket/path/to/output/</span>
<span class="n">operator</span> <span class="o">=</span> <span class="n">vision</span><span class="o">.</span><span class="n">async_annotate_image</span><span class="p">(</span><span class="n">output_gcs_uri</span><span class="o">=</span><span class="n">output_path</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Wait until it finishes.</span>
<span class="n">timeout</span> <span class="o">=</span> <span class="mi">90</span> <span class="c1"># max time out seconds</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">operator</span><span class="o">.</span><span class="n">result</span><span class="p">(</span><span class="n">timeout</span><span class="p">)</span>

<span class="c1"># Download to local using Storage client if needed.</span>
<span class="n">output_dir</span> <span class="o">=</span> <span class="s2">&quot;/my/local/dir&quot;</span>
<span class="n">storage</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">output_config</span><span class="o">.</span><span class="n">gcs_destination</span><span class="o">.</span><span class="n">uri</span><span class="p">,</span> <span class="n">to_object</span><span class="o">=</span><span class="n">output_dir</span><span class="p">))</span>
</pre></div>
</div>
<p>Please note that currently async annotation only support input and output on GCS.</p>
</div>
</div>
<div class="section" id="storage">
<h2>Storage<a class="headerlink" href="#storage" title="Permalink to this headline">¶</a></h2>
<p>This class provides python apis to work with Google Cloud Storage. It provides intuitive methods to move files and
folders between local environment and Google Cloud Storage. This class uses Google Cloud Service authentication. For
details and instructions on Google Cloud Storage, please view
<a class="reference external" href="https://cloud.google.com/storage/docs">their doc web site</a>.</p>
<div class="section" id="id6">
<h3>Authentication<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<p>Google storage service credential file is similar to Google Vision credentials. You cannot authenticate it with Google
Suite classes (drive, gmail and sheets).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">storage_auth</span> <span class="o">=</span> <span class="n">Authentication</span><span class="p">(</span><span class="n">credential</span><span class="o">=</span><span class="n">cloud_service_file</span><span class="p">,</span> <span class="n">services</span><span class="o">=</span><span class="s2">&quot;storage&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="instantiate-storage-class">
<h3>Instantiate Storage Class<a class="headerlink" href="#instantiate-storage-class" title="Permalink to this headline">¶</a></h3>
<p>Using the authenticated object, you can instantiate a storage class by:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">storage</span> <span class="o">=</span> <span class="n">Storage</span><span class="p">(</span><span class="n">service</span><span class="o">=</span><span class="n">storage_auth</span><span class="o">.</span><span class="n">get_service_client</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="section" id="upload-download-move-and-remove-files">
<h3>Upload, Download, Move and Remove Files<a class="headerlink" href="#upload-download-move-and-remove-files" title="Permalink to this headline">¶</a></h3>
<p>You can upload a single file:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">storage</span><span class="o">.</span><span class="n">upload</span><span class="p">(</span><span class="n">from_object</span><span class="o">=</span><span class="s2">&quot;/home/user/my_local_file.txt&quot;</span><span class="p">,</span>
                        <span class="n">to_object</span><span class="o">=</span><span class="s2">&quot;gs://my_bucket/my/path/to/target_file.txt&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>You can also upload a folder. This will recursively upload every file in the folder</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">storage</span><span class="o">.</span><span class="n">upload</span><span class="p">(</span><span class="n">from_object</span><span class="o">=</span><span class="s2">&quot;/home/user/my_local_folder&quot;</span><span class="p">,</span>
                        <span class="n">to_object</span><span class="o">=</span><span class="s2">&quot;gs://my_bucket/my/path/to/target_folder&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that this method persists the structure of source folder. In the above example, if the source folder structure is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">user</span><span class="o">/</span><span class="n">my_local_folder</span>
 <span class="o">|</span><span class="n">_</span> <span class="n">a</span><span class="o">.</span><span class="n">txt</span>
 <span class="o">|</span><span class="n">_</span> <span class="n">subfolder</span>
     <span class="o">|</span><span class="n">_</span> <span class="n">b</span><span class="o">.</span><span class="n">txt</span>
     <span class="o">|</span><span class="n">_</span> <span class="n">c</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>Then the uploaded structure would be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gs</span><span class="p">:</span><span class="o">//</span><span class="n">my_bucket</span><span class="o">/</span><span class="n">my</span><span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">target_folder</span>
 <span class="o">|</span><span class="n">_</span> <span class="n">a</span><span class="o">.</span><span class="n">txt</span>
 <span class="o">|</span><span class="n">_</span> <span class="n">subfolder</span>
     <span class="o">|</span><span class="n">_</span> <span class="n">b</span><span class="o">.</span><span class="n">txt</span>
     <span class="o">|</span><span class="n">_</span> <span class="n">c</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>You can download file or folder from Google Cloud. Similarly, if the source object is a folder, that this method
persists the structure of source folder.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">storage</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="n">from_object</span><span class="o">=</span><span class="s2">&quot;gs://my_bucket/my/path/to/target_folder&quot;</span><span class="p">,</span>
                          <span class="n">to_object</span><span class="o">=</span><span class="s2">&quot;/home/user/my_local_folder&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>To copy files or folders from one Google Storage location to another:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">storage</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">from_object</span><span class="o">=</span><span class="s2">&quot;gs://my_bucket/my/path/to/source_folder&quot;</span><span class="p">,</span>
                      <span class="n">to_object</span><span class="o">=</span><span class="s2">&quot;gs://my_bucket/my/path/to/destination_folder&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>To remove files or folders on Google Cloud:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">storage</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">target_object</span><span class="o">=</span><span class="s2">&quot;gs://my_bucket/my/path/to/target_folder&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="create-remove-and-get-bucket">
<h3>Create, Remove and Get Bucket<a class="headerlink" href="#create-remove-and-get-bucket" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">storage</span><span class="o">.</span><span class="n">create_bucket</span><span class="p">(</span><span class="n">bucket_name</span><span class="o">=</span><span class="s2">&quot;my_bucket&quot;</span><span class="p">)</span>
<span class="n">bucket</span> <span class="o">=</span> <span class="n">storage</span><span class="o">.</span><span class="n">get_bucket</span><span class="p">(</span><span class="n">bucket_name</span><span class="o">=</span><span class="s2">&quot;my_bucket&quot;</span><span class="p">)</span>
<span class="n">storage</span><span class="o">.</span><span class="n">remove_bucket</span><span class="p">(</span><span class="n">bucket_name</span><span class="o">=</span><span class="s2">&quot;my_bucket&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="auth.html" class="btn btn-neutral float-right" title="Auth" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="Welcome to pysuite’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Weiwen Gu

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>